<nav-header css="headerpages" text="My CPD DashBoard"></nav-header>
<nav-sidebar></nav-sidebar>
<div class="row">



    <div class="col-md-4">
        <div class="dashboard_box">
            <div class="pull-right green_icon">
                <i class="fa fa-graduation-cap"></i>
            </div>
            {{vm.CPDHours.RequiredHours }} <span class="mediumfont">Hour</span>
            <div class="white_progress">

                <div class="white_progress_inner" style="width:100%;"></div>

            </div>
            <div class="dashboard-box-footer" id="dashBox1">
                <div id="courseToDo">
                    <span>Required</span>
                    <span style="float:right;">{{vm.displayYear}}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="dashboard_box">
            <div class="pull-right green_icon">
                <i class="fa fa-clock-o"></i>
            </div>

            {{vm.CPDHours.OverdueHours > 0 ? vm.CPDHours.OverdueHours :'0'}}  <span class="mediumfont">Hour {{vm.CPDHours.OverdueMinutes > 0 ? vm.CPDHours.OverdueMinutes :'0' }} Mins</span><div class="white_progress">

                <div class="white_progress_inner" style="width:100%;"></div>

            </div>
            <div class="dashboard-box-footer" id="remainingdashBox">
                <div id="courseToDo">
                    <span>Remaining</span>
                    <span style="float:right;">{{vm.displayYear}}</span>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-4">
        <div class="dashboard_box">
            <div class="pull-right green_icon">
                <i class="fa fa-trophy"></i>
            </div>
            {{vm.CPDHours.TotalHours > 0 ? vm.CPDHours.TotalHours :'0' }} <span class="mediumfont">Hour {{vm.CPDHours.TotalMinutes > 0 ? vm.CPDHours.TotalMinutes :'0'}}  Mins</span>

            <div class="white_progress">

                <div class="white_progress_inner" style="width:100%;"></div>

            </div>
            <div class="dashboard-box-footer" id="completedDashBox">
                <div id="courseToDo">
                    <span>COMPLETED</span>
                    <span style="float:right;">{{vm.displayYear}}</span>
                </div>
            </div>
        </div>
    </div>
</div>
<br />

<div class="panel panel-default">
    <div class="panel-heading-cpd-3"><i class="fa fa-filter" title="Search" style="padding-top:10px;padding-bottom:10px;padding-left:10px;" tooltip> Search</i></div>

    <div class="shadow">
        <div layout-gt-sm="row">
            <div style="padding: 1rem 1rem">

                <div class="form-group input-group">
                    <span class="has-float-label" style="width:590px;">
                        <input class="form-control" ng-model="vm.pagingInfo.CourseName" type="text" id="courseName" placeholder="Course Name">
                        <label for="courseName">Course Name</label>
                    </span>
                    <div class="has-float-label" style="width:575px;">
                        <select ng-model="vm.pagingInfo.Year" class="form-control" id="Year">
                            <option ng-repeat="year in vm.years" ng-value="year">{{ year }}</option>
                        </select>
                        <label for="Year">Year</label>
                    </div>
                </div>
                <div class="form-group input-group">
                    <span class="has-float-label" style="width:590px;">
                        <input class="form-control" ng-model="vm.pagingInfo.LocationName" type="text" id="LocationName" placeholder="Location Name">
                        <label for="LocationName">Location Name</label>
                    </span>


                    <div class="has-float-label" style="width:575px;">
                        <p class="input-group">
                            <input type="text" class="form-control" name="courseDate" placeholder="Enter Start Date" ng-model="vm.pagingInfo.StartDate" my-date-picker end-date="+3y" />
                            <span class="input-group-addon" data-toggle="datepicker">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </span>
                        </p>
                        <label for="courseDate">Enter Start Date</label>
                    </div>

                </div>

                <div class="form-group input-group">

                    <div class="has-float-label" style="width:560px;">
                        <select class="form-control" id="host" ng-model="vm.HostId" ng-options="item.ID as item.Name for item in vm.hosts"></select>
                        <label for="host">Host</label>
                    </div>
                </div>

                    <div class="clearfix"></div>
                    <div class="row">
                        <button class="btn btn-primary" ng-click="vm.search()" style="margin-left:40px;margin-bottom:10px;"><span class="glyphicon glyphicon-search"></span> Search</button>
                        <button class="btn btn-primary" ng-click="vm.clear()" style="margin-left:10px;margin-bottom:10px;"><span class="glyphicon glyphicon-remove-sign"></span> Clear</button>
                    </div>
                </div>


        </div>
    </div>
</div>


<!--<div ng-if="vm.showDeclare">
    <div class="alert alert-success alert-white rounded">
        <button type="button" data-dismiss="alert" aria-hidden="true" class="close">×</button>
        <div class="icon">
            <i class="fa fa-info-circle" ></i>
        </div>

         Please declare your CPD for the previous year {{vm.previousYear}}

        <div class="clearfix"></div>
        <div class="row">
            <a class="btn DeclareButton btn-lg" role="button" ng-click="vm.declareCPD()"><span class="glyphicon glyphicon-thumbs-up"></span> Declare</a>

        </div>

    </div>
</div>-->


    <div class="row">
        <div id="gridTopItems">
            <div class="gridTopButtons">
                <button type="button" class="btn btn-danger btn-circle btn-lg" tooltip ng-click="vm.print()"><i class="fa fa-print"></i></button>
                <div class="btn-group" dropdown is-open="status.isopen">
                    <button type="button" class="btn btn-success  btn-lg dropdown-toggle" style="border-radius: 24px;" ng-disabled="disabled">
                        <i class="fa fa-file-pdf-o"></i>
                    </button>

                    <ul class="dropdown-menu" role="menu">
                        <li ng-repeat="year in vm.printYear"><a ng-click="vm.DownloadPDF(year)" download>{{year}}</a>                       
                            <span class="divider"></span>
                        </li> 
                    </ul>
                </div>
                <button type="button" class="btn btn-primary btn-circle btn-lg" tooltip ng-click="vm.addCPD()"><i class="fa fa-plus"></i></button>            
            </div>

            <div class="gridTopDropdown">
                Show <select class="input-sm" ng-model="vm.pagingInfo.pageSize" ng-options="o for o in vm.entries" ng-change="vm.setItemsPerPage(vm.pagingInfo.pageSize)" ng-init="vm.pagingInfo.pageSize = vm.entries[0]"></select>  entries
            </div>
        </div>
    </div>

    <div ng-if="vm.loadingaccreditdata">
        <div class="col-xs-4"></div>
        <div class="col-xs-4">
            <i class="fa fa-refresh fa-5x fa-spin"></i> <label class="label label-primary">Loading my cpd dashboard...</label>
        </div>
        <div class="col-xs-4"></div>
    </div>

    <div class="table-responsive" ng-if="!vm.loadingaccreditdata">
        <table class="table table-striped table-bordered table-hover table-condensed" id="cpdtable">
            <thead>
                <tr class="header">
                    <th></th>
                    <th><a href="" ng-click="vm.sort('CPDTypeName')">Course Type</a></th>
                    <th><a href="" ng-click="vm.sort('CourseName')">Course</a></th>
                    <th><a href="" ng-click="vm.sort('Hours')">Completed Hours</a></th>
                    <th><a href="" ng-click="vm.sort('CompletionDate')">Completion Date</a></th>
                    <th><a href="" ng-click="vm.sort('Venue')">Venue</a></th>
                    <th><a href="" ng-click="vm.sort('Trainer')">Trainer</a></th>
                    <th><a href="" ng-click="vm.sort('Company')">Host</a></th>
                    <th><a href="" ng-click="vm.sort('StartDate')">Start Date</a></th>
                    <th colspan="2"></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="row in vm.approvedCPDData">
                    <td><img ng-src="{{row.ImagePath}}" class="img-responsive center-block" /></td>
                    <td>{{::row.CPDTypeName}}</td>
                    <td>{{::row.CourseName}}</td>
                    <td>{{::row.Duration}} </td>
                    <td>{{::row.CompletionDate | date}}</td>
                    <td>{{::row.Venue}}</td>
                    <td>{{::row.Trainer}}</td>
                    <td>{{::row.Company}}</td>
                    <td>{{::row.StartDate | date}}</td>
                    <td ng-if="!row.IsLocked && row.WorkflowStepId!=4">
                        <i title="Edit CPD" class="fa fa-edit" style="font-size:20px;cursor:pointer" data-placement="top" ng-click="vm.editCPD(row)" tooltip> </i>
                    </td>
                    <td ng-if="!row.IsLocked && row.WorkflowStepId!=4">
                        <i title="Delete CPD" class="fa fa-trash" ng-click="vm.deleteCPD(row.CPDWorkflowId)" style="font-size:20px;cursor:pointer" tooltip  ></i>
                    </td>
                    <td ng-if="row.IsLocked && row.WorkflowStepId!=4">
                        <i title="View CPD" class="fa fa fa-eye" style="font-size:20px;cursor:pointer" ng-click="vm.editCPD(row)" tooltip></i>
                    </td>

                    <td ng-if="row.WorkflowStepId == 4">
                        <i title="Waiting for an approval" class="fa fa-clock-o" style="font-size:20px;cursor:pointer" tooltip></i>
                    </td>
                </tr>
            </tbody>
        </table>

        <div ng-if="!vm.loadingaccreditdata && vm.totalItems == '0'">
            <p>There is no data to show in the grid.</p><br />
        </div>

        <pagination page="vm.pagingInfo.page"
                    total-items="vm.totalItems"
                    items-per-page="vm.pagingInfo.pageSize"
                    on-select-page="vm.selectPage(page)"
                    max-size="10"
                    rotate="false"></pagination>
    </div>

